Windows Registry Editor Version 5.00

;--------------------------------------------------------------------------------------------
;   使win11使用旧版windows菜单
[HKEY_CURRENT_USER\Software\Classes\CLSID\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\InprocServer32]
@=""

;--------------------------------------------------------------------------------------------
;   重定向用户文件夹
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders]
;   Downloads folder
"{374DE290-123F-4565-9164-39C4925E467B}"="D:\\Downloads"
"{7D83EE9B-2244-4E70-B1F5-5393042AF1E4}"="D:\\Downloads"
;   OneDrive folder
"{24D89E24-2F19-4534-9DDE-6A6671FBB8FE}"="D:\Chuckie\OneDrive\Documents"
"{339719B5-8C47-4894-94C2-D8F77ADD44A6}"="D:\Chuckie\OneDrive\Pictures"
"{A52BBA46-E9E1-435F-B3D9-28DAA648C0F6}"="D:\Chuckie\OneDrive"
;   Desktop
"{754AC886-DF64-4CBA-86B5-F7FBF4FBCEF5}"="D:\Chuckie\OneDrive\Desktop"
"Desktop"="D:\Chuckie\OneDrive\Desktop"

;--------------------------------------------------------------------------------------------
;   隐藏开始菜单中“推荐的项目”
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer]
"HideRecommendedSection"=dword:00000001

;--------------------------------------------------------------------------------------------
;   开始菜单 > 更多固定项
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
"Start_Layout"=dword:00000001

;--------------------------------------------------------------------------------------------
; Disables the lockscreen 直接跳过锁屏，进入登录或桌面界面。
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Authentication\LogonUI\SessionData]
"AllowLockScreen"=dword:00000000

;--------------------------------------------------------------------------------------------
; enabled LongPaths support
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem]
"LongPathsEnabled"=dword:00000001

;--------------------------------------------------------------------------------------------
; Associate files with no extension to VSCode
[HKEY_CLASSES_ROOT\.]
[HKEY_CLASSES_ROOT\.\shell]
[HKEY_CLASSES_ROOT\.\shell\open]
[HKEY_CLASSES_ROOT\.\shell\open\command]
@="\"%USERPROFILE%\\Scoop\\apps\\vscode\\current\\Code.exe\" \"%1\""

;--------------------------------------------------------------------------------------------
; Enable Apps Dark Mode
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Themes\Personalize]
"AppsUseLightTheme"=dword:00000000
; Enable System Dark Mode
"SystemUsesLightTheme"=dword:00000000

;--------------------------------------------------------------------------------------------
; 显示 所有系统托盘图标
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer]
"EnableAutoTray"=-

;--------------------------------------------------------------------------------------------
; open file location in new window
; https://github.com/DKCTC/windows-explorer-open-file-background-location
; TODO: 将其通过scoop安装
[HKEY_CLASSES_ROOT\*\shell\1openloc]
@="Open file location in new window"
"Icon"="%windir%\\System32\\shell32.dll,3"
[HKEY_CLASSES_ROOT\*\shell\1openloc\command]
@="explorer.exe /select,\"%1\""
[HKEY_CLASSES_ROOT\Directory\Background\shell\1openloc]
@="Open this folder in new window"
"Icon"="%windir%\\System32\\shell32.dll,3"
[HKEY_CLASSES_ROOT\Directory\Background\shell\1openloc\command]
@="explorer.exe \"%V\""

;--------------------------------------------------------------------------------------------
; view certain file types as .txt in windows file explorer
; https://gist.github.com/davebrny/d88e0f79e7ac3630b66e4cc4f7c73bd2
; TODO: 添加更多文件，将其通过scoop安装
[HKEY_CLASSES_ROOT\.ahk]
"PerceivedType"="text"
[HKEY_CLASSES_ROOT\.md]
"PerceivedType"="text"
[HKEY_CLASSES_ROOT\.menu]
"PerceivedType"="text"
[HKEY_CLASSES_ROOT\.note]
"PerceivedType"="text"
[HKEY_CLASSES_ROOT\.sublime-snippet]
"PerceivedType"="text"

;--------------------------------------------------------------------------------------------
; Windows Media Player Skip EULA + First Time usage dialog
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\MediaPlayer\Preferences]
"AcceptedEULA"=dword:00000001
"FirstTime"=dword:00000001
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\WindowsMediaPlayer]
"GroupPrivacyAcceptance"=dword:00000001

;--------------------------------------------------------------------------------------------
;Allow Windows Updates for other products (e.g. Microsoft Office)
[HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\WindowsUpdate\Services\7971f918-a847-4430-9279-4a52d1efe18d]
"RegisteredWithAU"=dword:00000001

;--------------------------------------------------------------------------------------------
;Remove windows store taskbar
[HKEY_CURRENT_USER\SOFTWARE\Policies\Microsoft\Windows\Explorer]
"NoPinningStoreToTaskbar"=dword:00000001
[HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\Explorer]
"NoPinningStoreToTaskbar"=dword:00000001

;--------------------------------------------------------------------------------------------
;Keep NUMLock always on
[HKEY_CURRENT_USER\Control Panel\Keyboard]
"InitialKeyboardIndicators"="2"

;--------------------------------------------------------------------------------------------
; Add_Open_Location_context_menu
; 为多个文件类型和系统对象（如符号链接、快捷方式、最近文档、搜索结果等）添加 "打开包含文件夹" 选项，允许用户通过右键点击快速打开文件所在的文件夹。
[HKEY_CLASSES_ROOT\.symlink\shellex\ContextMenuHandlers\OpenContainingFolderMenu]
@="{37ea3a21-7493-4208-a011-7f9ea79ce9f5}"
[HKEY_CLASSES_ROOT\LibraryLocation\ShellEx\ContextMenuHandlers\OpenContainingFolderMenu]
@="{37ea3a21-7493-4208-a011-7f9ea79ce9f5}"
[HKEY_CLASSES_ROOT\lnkfile\shellex\ContextMenuHandlers\OpenContainingFolderMenu]
@="{37ea3a21-7493-4208-a011-7f9ea79ce9f5}"
[HKEY_CLASSES_ROOT\RecentDocument\ShellEx\ContextMenuHandlers\OpenContainingFolderMenu]
@="{37ea3a21-7493-4208-a011-7f9ea79ce9f5}"
[HKEY_CLASSES_ROOT\Results\ShellEx\ContextMenuHandlers\OpenContainingFolderMenu]
@="{37ea3a21-7493-4208-a011-7f9ea79ce9f5}"


;--------------------------------------------------------------------------------------------
; Show all icons in the Control Panel
[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel]
"AllItemsIconView"=dword:00000002
"StartupPage"=dword:00000001

;--------------------------------------------------------------------------------------------
; Fix Slow-Loading Windows Icons by Increasing the Icon Cache
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer]
"Max Cached Icons"="4096"


;--------------------------------------------------------------------------------------------
;   性能选项

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
; 禁止为桌面上的图标启用阴影效果。ListviewShadow=1 启用阴影。
"ListviewShadow"=dword:00000000

[HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\VisualEffects\AnimateMinMax]
; 禁用窗口在最小化或最大化时的动画效果。DefaultApplied=1 和 DefaultValue=0 禁用该动画。
"DefaultApplied"=dword:00000001
"DefaultValue"=dword:00000000
[HKEY_CURRENT_USER\Control Panel\Desktop\WindowMetrics]
"MinAnimate"="0"

[HKEY_CURRENT_USER\Control Panel\Desktop]
; 启用屏幕字体的平滑效果。FontSmoothingType=2 和 FontSmoothing=2 启用字体平滑。
"FontSmoothingType"=dword:2
"FontSmoothing"="2"

; UserPreferencesMask 设置为特定值，设置"性能选项"。
[HKEY_CURRENT_USER\Control Panel\Desktop]
; 同时关闭"性能选项"窗口中的八项:
; 2.窗口内的动画控件和元素
; 3.淡入淡出或滑动菜单到视图
; 4.滑动打开组合框
; 5.平滑滚动列表框
; 15.在窗口下显示阴影
; 16.在单击后淡出菜单
; 17.在视图中淡入淡出或滑动工具条提示
; 18.在鼠标指针下显示阴影
"UserPreferencesMask"=hex:90,12,03,80,10,00,00,00;


;--------------------------------------------------------------------------------------------
; Disables UAC
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]
"EnableLUA"=dword:00000000
; 需要管理员权限时直接提权，无需弹窗确认
[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System]
"ConsentPromptBehaviorAdmin"=dword:00000000
"ConsentPromptBehaviorUser"=dword:00000000


;--------------------------------------------------------------------------------------------
; 在设备管理器中显示设备的详细信息。DEVMGR_SHOW_DETAILS=1 启用详细信息。
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment]
"DEVMGR_SHOW_DETAILS"=dword:00000001


;--------------------------------------------------------------------------------------------

; 在文件资源管理器窗口的标题栏中显示完整路径。
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\CabinetState]
"FullPath"=dword:00000001

;   文件资源管理器选项
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced]
; 显示隐藏的文件、文件夹和驱动器。 1:显示隐藏的文件  2:不显示
"Hidden"=dword:00000001
; 显示已知文件类型的扩展名。1:隐藏  0:显示
"HideFileExt"=dword:00000000
; 显示受保护的操作系统文件（通常默认隐藏以防误删）。
"ShowSuperHidden"=dword:00000000
; 自动展开导航窗格中的文件夹树到当前打开的文件夹。
"NavPaneExpandToCurrentFolder" = dword:00000001
; 文件名保持大写。DontPrettyPath=1 使其显示原始大小写。
"DontPrettyPath"=dword:00000001
; 隐藏空的驱动器 1:隐藏  0:不隐藏
"HideDrivesWithNoMedia"=dword:00000000
; 隐藏桌面图标，1:隐藏  0:显示
"HideIcons"=dword:00000000
; 对图片始终显示图标 1:只显示图标  0:显示缩略图
"IconsOnly"=dword:00000000
; 在单独的进程打开文件夹窗口，1:是  0:否
"SeparateProcess"=dword:00000000
; 用彩色显示加密或压缩的NTFS文件，1:彩色显示  0:否
"ShowCompColor"=dword:00000001
; 鼠标指向时显示提示信息，1:显示  0:不显示
"ShowInfoTip"=dword:00000001
; Status bar (bottom) in Explorer.1:显示  0:不显示
"ShowStatusBar"=dword:00000001
; 在任务栏上显示“任务视图”按钮，1:显示  0:不显示
"ShowTaskViewButton"=dword:00000000
; 在缩略图上显示文件类型图标，1:显示  0:不显示
"ShowTypeOverlay"=dword:00000000
; 开始菜单中的搜索框的搜索设置，默认值为2，为0时最快
"Start_SearchFiles"=dword:00000000
; 开始菜单电源菜单显示更新，1:显示  0:不显示
"StartShownOnUpgrade"=dword:00000001
; 任务栏动画，1:启用  0:禁用
"TaskbarAnimations"=dword:00000000
; 合并任务栏按钮并隐藏标签， 0:始终合并  1:占满后合并  2:从不合并
"TaskbarGlomLevel"=dword:00000000
; 合并任务栏按钮并隐藏其他任务栏上的标签，0:始终合并  1:在任务栏已满时合并  2:从不合并
"MMTaskbarGlomLevel"=dword:00000000
; 任务栏聊天图标，1:显示  0:不显示
"TaskbarMn"=dword:00000000
; 锁定任务栏，1:不锁定 0:锁定
"TaskbarSizeMove"=dword:00000001
; 任务栏图标大小，0:默认大任务栏按钮  1:小任务栏按钮
"TaskbarSmallIcons"=dword:00000001
; 任务栏小组件按钮，1:显示  0:隐藏 注：该项权限不足无法写入
; "TaskbarDa"=dword:00000000

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Search]
; 任务栏搜索框状态，0:隐藏 1:仅搜索图标 2:搜索框 3:搜索图标和标签
"SearchboxTaskbarMode"=dword:00000000


;--------------------------------------------------------------------------------------------
;   在右键菜单中添加创建一个空白文件命令
; https://superuser.com/questions/920267/shellnew-icon-for-file-type
[HKEY_CLASSES_ROOT\.]
@="emptyFile"

[HKEY_CLASSES_ROOT\.\ShellNew]
"NullFile"=""
@="Empty File"
"ItemName"=""
"IconPath"="C:\\windows\\system32\\imageres.dll,2"

[HKEY_CLASSES_ROOT\.\ShellNew\Config]
"NoExtension"=""

[-HKEY_CLASSES_ROOT\emptyFile]

[HKEY_CLASSES_ROOT\emptyFile]
@="Empty File"

[HKEY_CLASSES_ROOT\emptyFile\DefaultIcon]
@="%SystemRoot%\\system32\\imageres.dll,2"


; 将caps lock map 为 ctrl
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout]
"Scancode Map"=hex:00,00,00,00,00,00,00,00,02,00,00,00,1d,00,3a,00,00,00,00,00

; windows powershell PageCode 改为 65110(0x 0000fde9)
[HKEY_CURRENT_USER\Console\%SystemRoot%_system32_cmd.exe]
"CodePage"=dword:0000fde9

